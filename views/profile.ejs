<%- include('partials/header') -%>
<div class="container">
  <div class="row mt-5">
    <div class="col-6">
      <div>
        <!--DISPLAY USER'S INFO-->
        <p><strong>User Name</strong>: <%= user.userName %></p>
        <p><strong>Email</strong>: <%= user.email %></p>
        <p><strong>Role</strong>: <%= user.role %></p>
        <!--Class Code-->
        <% if (user.role === "Teacher") { %>
        <p><strong>Class Code</strong>: <%= user.classCode %></p>
        <% } %>
        <!--Join a Class Button-->
        <% if (user.role === "Student") { %>
        <form action="/post/joinClass" method="POST">
          <div class="mb-3">
            <label for="joinClass" class="form-label">
              <strong>Join a Class:</strong>
            </label>
            <input
              type="text"
              class="form-control"
              id="joinClass"
              name="joinClass"
              placeholder="Enter Class Code"
            />

            <button type="submit" class="btn btn-primary" value="Join">
              Join
            </button>
          </div>
        </form>
        <% } %>
        <a href="/logout" class="col-3 btn btn-primary">Logout</a>
      </div>
      <div class="mt-5">
        <% if (user.role === "Teacher") { %>
        <h2>Add A New Task</h2>
        <form
          action="/post/createTask"
          enctype="multipart/form-data"
          method="POST"
        >
          <div class="mb-3">
            <label for="title" class="form-label">Topic:</label>
            <input type="text" class="form-control" id="title" name="title" />
          </div>
          <div class="mb-3">
            <label for="caption" class="form-label">Instructions:</label>
            <textarea
              class="form-control"
              id="caption"
              name="caption"
            ></textarea>
          </div>
          <div class="mb-3">
            <label for="imgUpload" class="form-label">File</label>
            <input
              type="file"
              class="form-control"
              id="imageUpload"
              name="file"
            />
          </div>
          <div class="mb-3">
            <label for="assign" class="form-label">Assign To:</label>
            <select class="form-control" id="assign" name="assign">
              <option value="" selected>-Select Student-</option>
              <% for (let i = 0; i < students.length; i++) { %>
              <option value="<%= students[i]._id %>">
                <%= students[i].lastName %> <%= students[i].firstName %>
              </option>
              <% } %>
            </select>
          </div>
          <button type="submit" class="btn btn-primary" value="Upload">
            Submit
          </button>
        </form>
        <% } %>
      </div>
    </div>

    <!--Display Students list for teacher-->
    <div class="col-6">
      <% if (isTeacher) { %>
      <h2>Students in My Class</h2>
      <% } %>
      <ul class="row list-unstyled">
        <% if (isTeacher) { %> <% for(var i = 0; i < students.length; i++) {%>
        <li class="col-6 justify-content-between mt-5">
          <%= students[i].userName %>
        </li>
        <% } %> <% } else { %> <% for(var i=0; i< posts.length; i++) {%>
        <li class="col-6 justify-content-between mt-5">
          <a href="/post/<%= posts[i]._id%>">
            <img class="img-fluid" src="<%= posts[i].image%>" />
          </a>
        </li>
        <% } %> <% } %>
      </ul>
      <div class="row justify-content-center mt-5">
        <% if (isTeacher) { %>
        <a class="btn btn-primary" href="/tasksFeed">See All Tasks</a>
        <% } else { %>
        <a class="btn btn-primary" href="/tasksFeed">All My Tasks</a>
        <% } %>
      </div>
    </div>
  </div>
</div>
<%- include('partials/footer') -%>
